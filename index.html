<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aspect Ratio Helper</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Aspect Ratio Helper</h1>
            <p class="subtitle">Calculate and maintain perfect aspect ratios for your images and videos</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" data-tab="calculator">Calculator</button>
            <button class="tab-btn" data-tab="editor">Image Editor</button>
            <button class="tab-btn" data-tab="resizer">Image Resizer</button>
            <button class="tab-btn" data-tab="video">Video Editor</button>
        </div>

        <div class="tab-content active" id="calculator">
        <div class="calculator-layout">
            <!-- Top Row: Compact Controls -->
            <div class="calculator-controls-top">
                <div class="card">
                    <h2>Preset Ratios</h2>
                    <div class="preset-grid" id="presetRatios"></div>
                </div>

                <div class="card">
                    <h2>Custom Ratio</h2>
                    <div class="ratio-input-group">
                        <div class="input-wrapper">
                            <label for="ratioWidth">Width</label>
                            <input type="number" id="ratioWidth" min="1" step="1" placeholder="16">
                        </div>
                        <span class="ratio-separator">:</span>
                        <div class="input-wrapper">
                            <label for="ratioHeight">Height</label>
                            <input type="number" id="ratioHeight" min="1" step="1" placeholder="9">
                        </div>
                    </div>
                    <button id="applyCustomRatio" class="btn-primary" style="width: 100%; margin-top: 0.5rem;">Apply</button>
                </div>

                <div class="card">
                    <h2>Dimensions</h2>
                    <div class="dimension-controls">
                        <div class="input-group">
                            <label for="widthPx">Width</label>
                            <input type="number" id="widthPx" min="1" step="1" placeholder="1920">
                        </div>
                        <button id="swapBtn" class="btn-swap" title="Swap dimensions">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M7 16V4M7 4L3 8M7 4L11 8M17 8V20M17 20L21 16M17 20L13 16"/>
                            </svg>
                        </button>
                        <div class="input-group">
                            <label for="heightPx">Height</label>
                            <input type="number" id="heightPx" min="1" step="1" placeholder="1080">
                        </div>
                    </div>
                </div>

                <div class="card card-info">
                    <h2>Result</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Dimensions</span>
                            <span class="info-value" id="currentDimensions">—</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Ratio</span>
                            <span class="info-value" id="simplifiedRatio">—</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Decimal</span>
                            <span class="info-value" id="decimalRatio">—</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Bottom Row: Additional Controls -->
            <div class="calculator-controls-bottom">
                <div class="card">
                    <h3>Scale Multiplier</h3>
                    <div class="multiplier-controls">
                        <button class="multiplier-btn" data-multiplier="0.25">÷4</button>
                        <button class="multiplier-btn" data-multiplier="0.5">÷2</button>
                        <button class="multiplier-btn" data-multiplier="0.75">75%</button>
                        <button class="multiplier-btn multiplier-reset" data-multiplier="1">100%</button>
                        <button class="multiplier-btn" data-multiplier="1.5">150%</button>
                        <button class="multiplier-btn" data-multiplier="2">×2</button>
                        <button class="multiplier-btn" data-multiplier="4">×4</button>
                    </div>
                    <div class="custom-multiplier">
                        <input type="number" id="customMultiplier" placeholder="Custom %" min="1" step="1">
                        <button id="applyCustomMultiplier" class="btn-secondary">Apply</button>
                    </div>
                </div>

                <div class="card">
                    <h3>Common Presets</h3>
                    <div class="preset-buttons" id="pixelPresets"></div>
                </div>

                <div class="card">
                    <h3>Width Adjuster</h3>
                    <div class="slider-header">
                        <span id="sliderValue" class="slider-value">1920 px</span>
                    </div>
                    <input type="range" id="widthSlider" min="50" max="6000" value="1920" step="1">
                    <div class="slider-marks">
                        <span>50</span>
                        <span>3000</span>
                        <span>6000</span>
                    </div>
                </div>
            </div>
        </div>
        </div>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Orientation</span>
                        <span class="info-value" id="orientation">—</span>
                    </div>
                </div>
            </div>
        </div>
        </div>

        <div class="tab-content" id="editor">
            <div class="editor-container">
                <div class="upload-section">
                    <div class="upload-box" id="uploadBox">
                        <input type="file" id="imageInput" accept="image/*" hidden>
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17 8 12 3 7 8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                        <h3>Upload Image</h3>
                        <p>Click to select, drag and drop, or press Ctrl+V to paste</p>
                    </div>
                </div>

                <div class="editor-main" id="editorMain" style="display: none;">
                    <div class="editor-sidebar">
                        <div class="card">
                            <h2>Image Info</h2>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">Original Size</span>
                                    <span class="info-value" id="imageSize">—</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Aspect Ratio</span>
                                    <span class="info-value" id="imageRatio">—</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h2>Crop to Ratio</h2>
                            <div class="crop-ratios" id="cropRatios"></div>
                            <button id="resetCrop" class="btn-secondary" style="width: 100%; margin-top: 1rem;">Reset Crop</button>
                        </div>

                        <div class="card">
                            <h2>Actions</h2>
                            <button id="downloadBtn" class="btn-primary" style="width: 100%; margin-bottom: 0.5rem;">Download Cropped</button>
                            <button id="newImageBtn" class="btn-secondary" style="width: 100%;">Upload New Image</button>
                        </div>
                    </div>

                    <div class="canvas-container">
                        <div class="canvas-wrapper" id="canvasWrapper">
                            <canvas id="imageCanvas"></canvas>
                            <div class="crop-overlay" id="cropOverlay">
                                <div class="crop-box" id="cropBox">
                                    <div class="crop-handle nw"></div>
                                    <div class="crop-handle ne"></div>
                                    <div class="crop-handle sw"></div>
                                    <div class="crop-handle se"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="resizer">
            <div class="resizer-container">
                <div class="upload-section">
                    <div class="mode-selector" style="margin-bottom: 1rem; text-align: center;">
                        <button class="mode-btn active" data-mode="single">Single Image</button>
                        <button class="mode-btn" data-mode="batch">Batch Processing</button>
                    </div>
                    <div class="upload-box" id="resizerUploadBox">
                        <input type="file" id="resizerInput" accept="image/*" hidden>
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M17 8l-5-5-5 5M12 3v12"/>
                        </svg>
                        <h3>Upload or Paste Image</h3>
                        <p>Drop an image here or click to browse</p>
                        <p class="help-text">Supports: JPG, PNG, WebP (Ctrl+V to paste)</p>
                    </div>
                    <div class="upload-box" id="batchUploadBox" style="display: none;">
                        <input type="file" id="batchInput" accept="image/*" multiple hidden>
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="3" y="3" width="7" height="7"/>
                            <rect x="14" y="3" width="7" height="7"/>
                            <rect x="3" y="14" width="7" height="7"/>
                            <rect x="14" y="14" width="7" height="7"/>
                        </svg>
                        <h3>Upload Multiple Images</h3>
                        <p>Drop images here or click to select multiple files</p>
                        <p class="help-text">All images will be resized to the same dimensions</p>
                    </div>
                </div>

                <div id="resizerMain" style="display: none;">
                    <div class="resizer-controls">
                        <div class="card">
                            <h2>Original Image</h2>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">Dimensions</span>
                                    <span class="info-value" id="resizerOriginalSize">—</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">File Size</span>
                                    <span class="info-value" id="resizerOriginalFileSize">—</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Format</span>
                                    <span class="info-value" id="resizerOriginalFormat">—</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h2>Resize Options</h2>
                            <div class="resize-method">
                                <label>Resize Method</label>
                                <div class="resize-method-buttons">
                                    <button class="method-btn active" data-method="percentage">Percentage</button>
                                    <button class="method-btn" data-method="dimensions">Dimensions</button>
                                    <button class="method-btn" data-method="filesize">File Size</button>
                                </div>
                            </div>

                            <div class="resize-percentage" id="resizePercentage">
                                <label for="percentageSlider">Scale: <span id="percentageValue">100%</span></label>
                                <input type="range" id="percentageSlider" min="5" max="100" value="100" step="5">
                                <div class="slider-marks">
                                    <span>5%</span>
                                    <span>50%</span>
                                    <span>100%</span>
                                </div>
                            </div>

                            <div class="resize-dimensions" id="resizeDimensions" style="display: none;">
                                <div class="dimension-controls">
                                    <div class="input-group">
                                        <label for="resizerWidth">Width (px)</label>
                                        <input type="number" id="resizerWidth" min="1" step="1">
                                    </div>
                                    <button id="resizerLockBtn" class="btn-lock active" title="Lock aspect ratio">
                                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                            <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                        </svg>
                                    </button>
                                    <div class="input-group">
                                        <label for="resizerHeight">Height (px)</label>
                                        <input type="number" id="resizerHeight" min="1" step="1">
                                    </div>
                                </div>
                                <div class="preset-resize-buttons">
                                    <button class="preset-resize-btn" data-width="1920" data-height="1080">1080p</button>
                                    <button class="preset-resize-btn" data-width="1280" data-height="720">720p</button>
                                    <button class="preset-resize-btn" data-width="800" data-height="600">800×600</button>
                                    <button class="preset-resize-btn" data-width="640" data-height="480">640×480</button>
                                </div>
                            </div>

                            <div class="resize-filesize" id="resizeFilesize" style="display: none;">
                                <label for="targetFilesize">Target Size (KB)</label>
                                <input type="number" id="targetFilesize" min="10" step="10" placeholder="500">
                                <p class="help-text">Quality will be adjusted to reach target size</p>
                            </div>
                        </div>

                        <div class="card">
                            <h2>Output Settings</h2>
                            <div class="output-format">
                                <label>Format</label>
                                <select id="outputFormat">
                                    <option value="image/jpeg">JPEG</option>
                                    <option value="image/png">PNG</option>
                                    <option value="image/webp">WebP</option>
                                </select>
                            </div>
                            <div class="quality-control">
                                <label for="qualitySlider">Quality: <span id="qualityValue">90%</span></label>
                                <input type="range" id="qualitySlider" min="10" max="100" value="90" step="5">
                            </div>
                            <button id="applyResize" class="btn-primary" style="width: 100%; margin-top: 1rem;">Apply Resize</button>
                        </div>

                        <div class="card">
                            <h2>Result</h2>
                            <div class="info-grid" id="resultInfo" style="display: none;">
                                <div class="info-item">
                                    <span class="info-label">New Dimensions</span>
                                    <span class="info-value" id="resizerNewSize">—</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">New File Size</span>
                                    <span class="info-value" id="resizerNewFileSize">—</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Reduction</span>
                                    <span class="info-value" id="resizerReduction">—</span>
                                </div>
                            </div>
                            <button id="downloadResized" class="btn-primary" style="width: 100%; margin-top: 1rem; display: none;">Download Resized</button>
                            <button id="newResizerImageBtn" class="btn-secondary" style="width: 100%; margin-top: 0.5rem;">Upload New Image</button>
                        </div>
                    </div>

                    <div class="resizer-preview">
                        <div class="preview-section">
                            <h3>Original Preview</h3>
                            <div class="preview-wrapper">
                                <img id="resizerOriginalPreview" style="max-width: 100%; border-radius: 8px;">
                            </div>
                        </div>
                        <div class="preview-section" id="resizerResultSection" style="display: none;">
                            <h3>Resized Preview</h3>
                            <div class="preview-wrapper">
                                <img id="resizerResultPreview" style="max-width: 100%; border-radius: 8px;">
                            </div>
                        </div>
                    </div>
                </div>

                <div id="batchMain" style="display: none;">
                    <div class="batch-controls">
                        <div class="card">
                            <h2>Batch Settings</h2>
                            <div class="batch-settings-grid">
                                <div class="setting-group">
                                    <label>Target Dimensions</label>
                                    <div class="dimension-controls">
                                        <div class="input-group">
                                            <label for="batchWidth">Width</label>
                                            <input type="number" id="batchWidth" value="1024" min="64" step="64">
                                        </div>
                                        <button id="batchLockBtn" class="btn-lock active" title="Lock aspect ratio">
                                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                                <path d="M7 11V7a5 5 0 0 1 10 0v4"/>
                                            </svg>
                                        </button>
                                        <div class="input-group">
                                            <label for="batchHeight">Height</label>
                                            <input type="number" id="batchHeight" value="1024" min="64" step="64">
                                        </div>
                                    </div>
                                    <div class="preset-resize-buttons" style="margin-top: 0.5rem;">
                                        <button class="preset-resize-btn batch-preset" data-width="512" data-height="512">512×512</button>
                                        <button class="preset-resize-btn batch-preset" data-width="768" data-height="768">768×768</button>
                                        <button class="preset-resize-btn batch-preset" data-width="1024" data-height="1024">1024×1024</button>
                                        <button class="preset-resize-btn batch-preset" data-width="1024" data-height="768">1024×768</button>
                                    </div>
                                </div>

                                <div class="setting-group">
                                    <label>Resize Mode</label>
                                    <select id="batchResizeMode">
                                        <option value="stretch">Stretch to Fit</option>
                                        <option value="cover" selected>Cover (Crop to Fit)</option>
                                        <option value="contain">Contain (Fit Inside)</option>
                                    </select>
                                    <p class="help-text" style="margin-top: 0.5rem; font-size: 0.85rem;">
                                        <strong>Cover:</strong> Fills target size, crops excess<br>
                                        <strong>Contain:</strong> Fits inside target, adds padding<br>
                                        <strong>Stretch:</strong> Stretches to exact size<br><br>
                                        <strong>⚠️ Upscaling:</strong> Images smaller than target will be upscaled (pixels enlarged). For best quality, use source images at or above target size.
                                    </p>
                                </div>

                                <div class="setting-group">
                                    <label>Output Format</label>
                                    <select id="batchFormat">
                                        <option value="image/jpeg">JPEG</option>
                                        <option value="image/png" selected>PNG</option>
                                        <option value="image/webp">WebP</option>
                                    </select>
                                </div>

                                <div class="setting-group">
                                    <label for="batchQuality">Quality: <span id="batchQualityValue">95%</span></label>
                                    <input type="range" id="batchQuality" min="60" max="100" value="95" step="5">
                                </div>
                            </div>
                            
                            <div style="margin-top: 1rem;">
                                <button id="processBatch" class="btn-primary" style="width: 100%; padding: 0.75rem; font-size: 1rem;">
                                    Process All Images
                                </button>
                                <div id="batchProgress" style="display: none; margin-top: 1rem;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 0.5rem;">
                                        <span id="batchProgressText">Processing...</span>
                                        <span id="batchProgressCount">0 / 0</span>
                                    </div>
                                    <div style="background: var(--bg-secondary); height: 8px; border-radius: 4px; overflow: hidden;">
                                        <div id="batchProgressBar" style="background: var(--accent); height: 100%; width: 0%; transition: width 0.3s;"></div>
                                    </div>
                                </div>
                                <button id="downloadAllBatch" class="btn-primary" style="width: 100%; margin-top: 0.5rem; display: none;">
                                    Download All as ZIP
                                </button>
                                <button id="newBatchBtn" class="btn-secondary" style="width: 100%; margin-top: 0.5rem;">
                                    Upload New Batch
                                </button>
                            </div>
                        </div>

                        <div class="card">
                            <h2>Image List (<span id="batchCount">0</span>)</h2>
                            <div id="batchImageList" style="max-height: 400px; overflow-y: auto;">
                                <p class="help-text" style="text-align: center; padding: 2rem;">No images uploaded yet</p>
                            </div>
                        </div>
                    </div>

                    <div class="batch-preview">
                        <h3>Preview</h3>
                        <div id="batchPreviewGrid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 1rem; padding: 1rem;">
                            <p class="help-text" style="text-align: center; padding: 2rem; grid-column: 1 / -1;">Process images to see results</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" id="video">
            <div class="video-editor-container">
                <div class="upload-section">
                    <div class="upload-box" id="videoUploadBox">
                        <input type="file" id="videoInput" accept="video/*" hidden>
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="23 7 16 12 23 17 23 7"/>
                            <rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
                        </svg>
                        <h3>Upload Video</h3>
                        <p>Click to select, drag and drop, or press Ctrl+V to paste</p>
                        <p style="font-size: 0.85rem; color: var(--text-muted); margin-top: 0.5rem;">Supports MP4, WebM, MOV, and more</p>
                        <div id="ffmpegLoadingStatus" style="margin-top: 1rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-radius: 8px; display: none;">
                            <p style="margin: 0; font-size: 0.9rem; color: var(--accent-light);">⏳ Loading video processor...</p>
                        </div>
                    </div>
                </div>

                <div class="video-editor-main" id="videoEditorMain" style="display: none;">
                    <div class="video-controls-top">
                        <div class="card">
                            <h2>Video Info</h2>
                            <div class="info-grid">
                                <div class="info-item">
                                    <span class="info-label">Dimensions</span>
                                    <span class="info-value" id="videoSize">—</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Duration</span>
                                    <span class="info-value" id="videoDuration">—</span>
                                </div>
                                <div class="info-item">
                                    <span class="info-label">Aspect Ratio</span>
                                    <span class="info-value" id="videoRatio">—</span>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h2>Speed Control</h2>
                            <div class="speed-controls">
                                <button class="speed-btn" data-speed="0.25">0.25×</button>
                                <button class="speed-btn" data-speed="0.5">0.5×</button>
                                <button class="speed-btn" data-speed="0.75">0.75×</button>
                                <button class="speed-btn active" data-speed="1">1×</button>
                                <button class="speed-btn" data-speed="1.25">1.25×</button>
                                <button class="speed-btn" data-speed="1.5">1.5×</button>
                                <button class="speed-btn" data-speed="2">2×</button>
                                <button class="speed-btn" data-speed="4">4×</button>
                            </div>
                            <div class="custom-speed">
                                <label>Custom Speed</label>
                                <input type="number" id="customSpeed" placeholder="e.g., 1.75" min="0.1" max="10" step="0.1">
                                <button id="applyCustomSpeed" class="btn-secondary">Apply</button>
                            </div>
                            <div class="speed-info">
                                <span class="info-label">Current Speed</span>
                                <span class="info-value" id="currentSpeed">1×</span>
                                <span class="info-label" style="margin-top: 0.5rem;">New Duration</span>
                                <span class="info-value" id="newDuration">—</span>
                            </div>
                        </div>

                        <div class="card">
                            <h2>Crop Video</h2>
                            <div class="crop-ratios" id="videoCropRatios"></div>
                            <button id="resetVideoCrop" class="btn-secondary" style="width: 100%; margin-top: 1rem;">Reset Crop</button>
                        </div>

                        <div class="card">
                            <h2>Export</h2>
                            <button id="processVideo" class="btn-primary" style="width: 100%; margin-bottom: 0.5rem;">Apply Changes</button>
                            <button id="downloadVideo" class="btn-primary" style="width: 100%; margin-bottom: 0.5rem; display: none;">Download Processed Video</button>
                            <button id="newVideoBtn" class="btn-secondary" style="width: 100%;">Upload New Video</button>
                            <div id="processingStatus" class="processing-status" style="display: none;">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="progressFill"></div>
                                </div>
                                <p id="statusText">Processing...</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="video-preview-container">
                        <div class="video-preview-section">
                            <h3 style="margin-bottom: 0.5rem; color: var(--text-secondary);">Original</h3>
                            <div class="video-wrapper" id="videoWrapper">
                                <video id="videoPreview" controls></video>
                                <div class="video-crop-overlay" id="videoCropOverlay" style="display: none;">
                                    <div class="crop-box" id="videoCropBox">
                                        <div class="crop-handle nw"></div>
                                        <div class="crop-handle ne"></div>
                                        <div class="crop-handle sw"></div>
                                        <div class="crop-handle se"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="video-preview-section" id="processedPreviewSection" style="display: none;">
                            <h3 style="margin-bottom: 0.5rem; color: var(--success);">Processed Preview</h3>
                            <div class="video-wrapper">
                                <video id="processedVideoPreview" controls></video>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="script.js"></script>
    <script src="editor.js"></script>
    <script src="resizer.js"></script>
    <script src="lib/ffmpeg.min.js"></script>
    <script src="video-editor.js"></script>
</body>
</html>